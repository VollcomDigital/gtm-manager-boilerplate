version: "3.11"

services:
  gtm-manager:
    build: .
    image: mms-gtm-manager:latest
    working_dir: /app
    volumes:
      - ./:/app
    environment:
      - GTM_AUTH_METHOD=user
      - GTM_CREDENTIALS_PATH=/secrets/client_secrets.json
      - GTM_OUTPUT_PATH=/app/data/exports/ga4_tags.csv
      - GTM_SALESLINE
      - GTM_SALESLINES_JSON
      - GTM_ACCOUNT_ID
      - GTM_CONTAINER_ID
    command: ["bash", "-lc", "scripts/export_ga4_tags.sh"]
